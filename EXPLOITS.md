# Exploits Documentation

This file contains documentation of the challenges we exploited as part of the CTF exercise. It includes the flags captured, the exploitation process, identified vulnerabilities, and suggested mitigations. **Note:** We did not attempt to capture flags from the challenge our group created.

---

## Challenge: epic_heisenberg

**Flag:**
`CTF{You did it! that is our flag: https://www.youtube.com/watch?v=YEReRb8rDCw}`

**Exploitation Steps:**

1. Registered a user (`admin@evil.com`)
2. Logged in and obtained a base64-encoded token containing the hashed `userId`
3. Decompiled the application JAR to reveal `VerifyToken.class`
4. Discovered that tokens are verified using:
   - `sha256(user_id + password)`
   - an in-memory access timestamp (`lastRequestedAccessToken`)
5. Reused the valid login token and changed only the `"role": "USER"` to `"ADMIN"`
6. Sent the updated token as a base64-encoded JSON string in the `accessToken` header
7. Gained access to `/schema`, which listed the `flag` table
8. Found the real flag in the migration script `V1_3__create_flag_table.sql`

**Vulnerability:**
- Custom insecure token system that accepts unsigned base64 JSON
- Token trust based solely on user-controlled fields (bad design)

**Mitigation:**
- Use real JWTs with strong HMAC or RSA signatures
- Never allow role elevation from client-side token data
- Store session state securely server-side with verified roles

---

## Challenge: happy_moore  
**Flags Captured:**  
- `CTF{flag1}`  
- `CTF{flag2}`  
- `CTF{flag3}`

**Exploitation Process:**  
- [Steps]

**Vulnerabilities Found:**  
- [Details]

**Mitigations:**  
- [Suggestions]

---

## Challenge: intelligent_hopper  
**Flags Captured:**  
- `CTF-1{flagA}`  
- `CTF-2{flagB}`  
- `CTF-3{flagC}`  
- `CTF-4{flagD}`  
- `CTF-5{flagE}`  
- `CTF-6{flagF}`  
- `CTF-7{flagG}`  
- `CFT 4{flagH}`

**Exploitation Process:**  
- [Steps]

**Vulnerabilities Found:**  
- [Details]

**Mitigations:**  
- [Suggestions]

---

## Challenge: jolly_diffie  
**Flags Captured:**  
- `CTF{flag1}`  
- `CTF{flag2}`  
- `CTF{flag3}`  
- `CTF{flag4}`  
- `CTF{flag5}`

**Exploitation Process:**  
- [Steps]

**Vulnerabilities Found:**  
- [Details]

**Mitigations:**  
- [Suggestions]

---

## Challenge: keen_hellman  
**Flags Captured:**  
- `CTF{flag1}`  
- `CTF{flag2}`  
- `CTF{flag3}`

**Exploitation Process:**  
- [Steps]

**Vulnerabilities Found:**  
- [Details]

**Mitigations:**  
- [Suggestions]

---


